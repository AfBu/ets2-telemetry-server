var Funbit;(function(n){(function(n){(function(n){(function(n){var t=function(){function n(n,t){this.firstRun=!0;this.endpointUrl=n;this.refreshDelay=t;this.initialize()}return n.prototype.initialize=function(){this.refreshData()},n.prototype.refreshData=function(){var t=this;$.ajax({url:this.endpointUrl,async:!0,dataType:"json",timeout:n.connectionTimeout}).done(function(n){return t.dataRefreshSucceeded(n)}).fail(function(){return t.dataRefreshFailed("Could not connect to the server")}).always(function(){t.timer=setTimeout(t.refreshData.bind(t),t.refreshDelay)})},n.prototype.formatNumber=function(n,t){for(var i=n+"";i.length<t;)i="0"+i;return i},n.prototype.isoToReadableDate=function(t){var i=new Date(t);return n.dayOfTheWeek[i.getDay()]+" "+this.formatNumber(i.getHours(),2)+":"+this.formatNumber(i.getMinutes(),2)},n.prototype.turnIndicator=function(n,t){var i="."+n;t?$(i).addClass("on"):$(i).removeClass("on")},n.prototype.setMeter=function(n,t,i,r,u,f){var o="."+n,s;t=Math.min(t,r);t=Math.max(t,i);var c=(t-i)/(r-i),e=(f-u)*c+u,l=$(o),h=parseInt($(o).data("prev"));if($(o).data("prev",e),s=function(n){l.css({transform:n,"-webkit-transform":n,"-moz-transform":n,"-ms-transform":n,"-o-transform":n})},Math.abs(h-e)<(f-u)*.005){s("rotate("+e+"deg)");return}$({a:h}).animate({a:e},{duration:this.refreshDelay*1.1,step:function(n){s("rotate("+n+"deg)")}})},n.prototype.setSpeedometer=function(n){this.setMeter("speedometer-arrow",n,0,140,-114,114)},n.prototype.setTachometer=function(n){this.setMeter("tachometer-arrow",n/100,0,24,-97,97)},n.prototype.setFuel=function(n,t){this.setMeter("fuel-arrow",n,0,t,-96,0)},n.prototype.setTemperature=function(n){this.setMeter("temperature-arrow",n,0,100,-96,0)},n.prototype.setIndicator=function(n,t){var i="."+n;$(i).html(t)},n.prototype.dataRefreshSucceeded=function(n){if(!n.connected){this.dataRefreshFailed("Simulator is not running");return}n.gameTime=this.isoToReadableDate(n.gameTime);n.jobDeadlineTime=this.isoToReadableDate(n.jobDeadlineTime);$(".gauge").hasClass("on")||$(".gauge").addClass("on");$(".time").removeClass("error");this.setIndicator("time",n.gameTime);n.sourceCity.length>0?(this.setIndicator("source",n.sourceCity+" ("+n.sourceCompany+")"),this.setIndicator("destination",n.destinationCity+" ("+n.destinationCompany+")"),this.setIndicator("deadline",n.jobDeadlineTime)):(this.setIndicator("source",""),this.setIndicator("destination",""),this.setIndicator("deadline",""));n.trailerAttached?(this.setIndicator("trailer-mass",n.trailerMass/1e3+"t"),this.setIndicator("trailer-name",n.trailerName)):(this.setIndicator("trailer-mass",""),this.setIndicator("trailer-name",""));this.setIndicator("odometer",(Math.round(n.truckOdometer*10)/10).toFixed(1));this.setIndicator("gear",n.gear>0?"D"+n.gear:n.gear<0?"R":"N");this.turnIndicator("trailer",n.trailerAttached);this.turnIndicator("blinker-left",n.blinkerLeftOn);this.turnIndicator("blinker-right",n.blinkerRightOn);this.turnIndicator("cruise",n.cruiseControlOn);this.turnIndicator("parking-lights",n.lightsParkingOn);this.turnIndicator("highbeam",n.lightsBeamHighOn);this.turnIndicator("lowbeam",n.lightsBeamLowOn&&!n.lightsBeamHighOn);this.setSpeedometer(n.truckSpeed*3.6);this.setTachometer(n.engineRpm);this.setFuel(n.fuel,n.fuelCapacity);this.setTemperature(n.waterTemperature)},n.prototype.dataRefreshFailed=function(n){($(".gauge").hasClass("on")||this.firstRun)&&(this.firstRun=!1,$(".gauge").removeClass("on"),$(".time").addClass("error"),this.setIndicator("time",n),this.setIndicator("source",""),this.setIndicator("destination",""),this.setIndicator("deadline",""),this.setIndicator("trailer-mass",""),this.setIndicator("trailer-name",""),this.setIndicator("odometer",""),this.setIndicator("gear",""),this.turnIndicator("trailer",!1),this.turnIndicator("blinker-left",!1),this.turnIndicator("blinker-right",!1),this.turnIndicator("cruise",!1),this.turnIndicator("parking-lights",!1),this.turnIndicator("highbeam",!1),this.turnIndicator("lowbeam",!1),this.setSpeedometer(0),this.setTachometer(0),this.setFuel(0,1),this.setTemperature(0))},n.dayOfTheWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n.connectionTimeout=5e3,n}();n.Gauge=t})(n.Components||(n.Components={}));var t=n.Components})(n.Telemetry||(n.Telemetry={}));var t=n.Telemetry})(n.Ets||(n.Ets={}));var t=n.Ets})(Funbit||(Funbit={}));